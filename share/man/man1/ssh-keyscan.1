.TH SSH-KEYSCAN 1 "February 10 2023 " ""
.SH NAME
\fBssh-keyscan\fP
\- gather SSH public keys from servers
.SH SYNOPSIS
.br
\fBssh-keyscan\fP
[\fB\-46cDHv\fP]
[\fB\-f\fP \fIfile\fP]
[\fB\-O\fP \fIoption\fP]
[\fB\-p\fP \fIport\fP]
[\fB\-T\fP \fItimeout\fP]
[\fB\-t\fP \fItype\fP]
[\fIhost\fP | \fIaddrlist\fP namelist]
.SH DESCRIPTION
\fBssh-keyscan\fP
is a utility for gathering the public SSH host keys of a number of
hosts.
It was designed to aid in building and verifying
\fIssh_known_hosts\fP
files,
the format of which is documented in
\fBsshd\fP(8).
\fBssh-keyscan\fP
provides a minimal interface suitable for use by shell and perl
scripts.

\fBssh-keyscan\fP
uses non-blocking socket I/O to contact as many hosts as possible in
parallel, so it is very efficient.
The keys from a domain of 1,000
hosts can be collected in tens of seconds, even when some of those
hosts are down or do not run
\fBsshd\fP(8).
For scanning, one does not need
login access to the machines that are being scanned, nor does the
scanning process involve any encryption.

Hosts to be scanned may be specified by hostname, address or by CIDR
network range (e.g. 192.168.16/28).
If a network range is specified, then all addresses in that range will
be scanned.

The options are as follows:
.TP
\fB\-4\fP
Force
\fBssh-keyscan\fP
to use IPv4 addresses only.
.TP
\fB\-6\fP
Force
\fBssh-keyscan\fP
to use IPv6 addresses only.
.TP
\fB\-c\fP
Request certificates from target hosts instead of plain keys.
.TP
\fB\-D\fP
Print keys found as SSHFP DNS records.
The default is to print keys in a format usable as a
\fBssh\fP(1)
\fIknown_hosts\fP
file.
.TP
\fB\-f\fP \fIfile\fP
Read hosts or
``addrlist namelist''
pairs from
\fIfile\fP,
one per line.
If
`-'
is supplied instead of a filename,
\fBssh-keyscan\fP
will read from the standard input.
Names read from a file must start with an address, hostname or CIDR network
range to be scanned.
Addresses and hostnames may optionally be followed by comma-separated name
or address aliases that will be copied to the output.
For example:

192.168.11.0/24
.br
10.20.1.1
.br
happy.example.org
.br
10.0.0.1,sad.example.org
.br
.TP
\fB\-H\fP
Hash all hostnames and addresses in the output.
Hashed names may be used normally by
\fBssh\fP(1)
and
\fBsshd\fP(8),
but they do not reveal identifying information should the file's contents
be disclosed.
.TP
\fB\-O\fP \fIoption\fP
Specify a key/value option.
At present, only a single option is supported:
.TP
\fBhashalg\fP=\fIalgorithm\fP
Selects a hash algorithm to use when printing SSHFP records using the
\fB\-D\fP
flag.
Valid algorithms are
``sha1''
and
``sha256''.
The default is to print both.
.TP
\fB\-p\fP \fIport\fP
Connect to
\fIport\fP
on the remote host.
.TP
\fB\-T\fP \fItimeout\fP
Set the timeout for connection attempts.
If
\fItimeout\fP
seconds have elapsed since a connection was initiated to a host or since the
last time anything was read from that host, the connection is
closed and the host in question considered unavailable.
The default is 5 seconds.
.TP
\fB\-t\fP \fItype\fP
Specify the type of the key to fetch from the scanned hosts.
The possible values are
``dsa'',
``ecdsa'',
``ed25519'',
``ecdsa-sk'',
``ed25519-sk'',
or
``rsa''.
Multiple values may be specified by separating them with commas.
The default is to fetch
``rsa'',
``ecdsa'',
``ed25519'',
``ecdsa-sk'',
and
``ed25519-sk''
keys.
.TP
\fB\-v\fP
Verbose mode:
print debugging messages about progress.

If an ssh_known_hosts file is constructed using
\fBssh-keyscan\fP
without verifying the keys, users will be vulnerable to
.IR man in the middle
attacks.
On the other hand, if the security model allows such a risk,
\fBssh-keyscan\fP
can help in the detection of tampered keyfiles or man in the middle
attacks which have begun after the ssh_known_hosts file was created.
.SH FILES
\fI/data/data/com.termux/files/usr/etc/ssh/ssh_known_hosts\fP
.SH EXAMPLES
Print the RSA host key for machine
\fIhostname\fP :

Dl $ ssh-keyscan -t rsa hostname

Search a network range, printing all supported key types:

Dl $ ssh-keyscan 192.168.0.64/25

Find all hosts from the file
\fIssh_hosts\fP
which have new or different keys from those in the sorted file
\fIssh_known_hosts\fP:

$ ssh-keyscan -t rsa,dsa,ecdsa,ed25519 -f ssh_hosts | \e
.br
	sort -u - ssh_known_hosts | diff ssh_known_hosts -
.br
.SH SEE ALSO
\fBssh\fP(1),
\fBsshd\fP(8)

\fIUsing DNS to Securely Publish Secure Shell (SSH) Key Fingerprints\fP, RFC 4255, 2006.
.SH AUTHORS

-nosplit

David Mazieres <Mt dm@lcs.mit.edu>
wrote the initial version, and

Wayne Davison <Mt wayned@users.sourceforge.net>
added support for protocol version 2.
